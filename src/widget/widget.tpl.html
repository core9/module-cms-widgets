<div class="page-header">
	<h1>Widget {{widget.name}}<small><i class="icon-double-angle-right"></i> manage your widgets</small></h1>
</div>
<div>
	<div class="input-group">
		<span class="input-group-addon">Name</span>
		<input type="text" class="form-control" ng-model="widget.name" />
	</div>
	<fieldset>
		<legend>Template</legend>
		<div class="input-group">
			<span class="input-group-addon">Template name</span>
			<input type="text" class="form-control" ng-model="widget.templateName" />
		</div>
		<div class="input-group">
			<span class="input-group-addon">Template</span>
			<div class="form-control" style="padding: 0 4px 0 0;">
				<div ui-codemirror="editorOptions" name="template" ng-model="widget.template">{{widget.template}}</div>
			</div>
		</div>
		<div class="input-group">
			<span class="input-group-addon">Editor options</span>
			<div class="form-control">
				<button type="button" class="btn btn-success" ng-click="editorOptions.fullScreen = true">Fullscreen</button>
			</div>
		</div>
	</fieldset>
	<fieldset ng-if="widget.type !== 'collection'">
		<legend>Datahandler</legend>
		<div class="input-group">
			<span class="input-group-addon">Datahandler</span>
			<button type="button" class="btn btn-default form-control dropdown-toggle">{{widget.handler}}<span class="caret"></span>
			</button>
			<ul class="dropdown-menu selectbox">
				<li ng-repeat="handler in datahandlers"><a ng-click="widget.handler = handler">{{handler}}</a></li>
			</ul>
		</div>
		<div ng-if="schema !== undefined && widget.handler !== 'Bundle'" >
			<div cn-schema-generator cn-schema="schema" cn-options="schemaOptions" cn-data="widget.handleroptions" />
		</div>
		<fieldset ng-if="widget.handler === 'Bundle'">
			<legend>Components</legend>
			<div ng-repeat="component in widget.handleroptions.components track by $index">
				<div class="input-group">
					<span class="input-group-addon">Widget</span>
					<button type="button" class="form-control btn btn-default dropdown-toggle">{{component.name}}</button>
					<ul class="dropdown-menu selectbox">
						<li ng-repeat="(component, options) in widgets"><a ng-click="widget.handleroptions.[$parent.$index] = component">{{component}}</a></li>
					</ul>
					<span class="input-group-btn">
						<button class="btn btn-warning" ng-click="edit = !edit"><i class="fa fa-pencil"></i> Settings</button>
						<button class="btn btn-danger" ng-click="removeComponent($index)"><i class="fa fa-trash-o"></i> Remove</button>
					</span>
				</div>
				<div class="input-group" ng-if="edit">
					<span class="input-group-addon">Settings</span>
					<div class="form-control">
						<fieldset>
							<legend>Widget settings</legend>
							<p>If your widget has options, you can set them here</p>
						</fieldset>
						<div class="input-group">
							<span class="input-group-addon">ID</span>
							<input type="text" class="form-control" ng-model="component.id" />
						</div>
						<fieldset ng-if="widgets[component.name].options !== null">
						<legend>Globals</legend>
						<div class="input-group" ng-repeat="(key, entry) in widgets[component.name].options" ng-if="entry.global">
							<span class="input-group-addon">{{key}}</span>
							<input type="text" class="form-control" ng-model="component.globals[key]" />
						</div>
					</fieldset>
					</div>
				</div>
			</div>
			<div class="input-group">
				<span class="input-group-addon">Add component</span>
				<button type="button" class="form-control btn btn-default dropdown-toggle">{{newComponent.name}}</button>
				<ul class="dropdown-menu selectbox">
					<li ng-repeat="(component, options) in widgets"><a ng-click="newComponent.name = component">{{component}}</a></li>
				</ul>
				<span class="input-group-btn">
					<button class="btn btn-success" ng-click="addComponent()">Add</button>
				</span>
			</div>
		</fieldset>
	</fieldset>
	<fieldset>
		<legend>Actions</legend>
		<button class="btn btn-success" ng-click="save()">Save</button>
	</fieldset>
	<div class="close-fullscreen clearfix" ng-show="editorOptions.fullScreen === true">
		<button type="button" class="btn btn-success" ng-click="save()">Save</button>
		<button type="button" class="btn btn-danger" ng-click="editorOptions.fullScreen = false;">&times;</button>
	</div>
</div>